# X.509 auth tests
#
# CASE 9: We try to modify a person object protected by a mntner
#         with a password and an X509 certificate.
#         Signed with wrong (different) certificate.
#         Both certificates have matching key-cert objects.
#         Correct password inside signed message.
#
# ./dbupdate -c ~/db/conf/rip.config -rm -f test
#
#
#SUCCESS
#
# RESULT 9: The modify will succeed.
%
%
$ -c $RIP_CONFIG -rm -f 
%
%
From: dbtest@ripe.net
MIME-Version: 1.0
Content-Type: multipart/signed; protocol="application/x-pkcs7-signature"; micalg=sha1; boundary="----D96B4EE3933FD612217FA51738EB9194"

This is an S/MIME signed message

------D96B4EE3933FD612217FA51738EB9194

person:       test person2
address:      Singel
phone:        +0123456789
nic-hdl:      TP2-DB-TEST
mnt-by:       TEST-MNT
changed:      dbtest@ripe.net 20020101
changed:      dbtest@ripe.net 20040101
source:       DB-TEST

password:  auth

------D96B4EE3933FD612217FA51738EB9194
Content-Type: application/x-pkcs7-signature; name="smime.p7s"
Content-Transfer-Encoding: base64
Content-Disposition: attachment; filename="smime.p7s"

MIIGigYJKoZIhvcNAQcCoIIGezCCBncCAQExCzAJBgUrDgMCGgUAMAsGCSqGSIb3
DQEHAaCCBAAwggP8MIIDZaADAgECAgIAhDANBgkqhkiG9w0BAQQFADBxMQswCQYD
VQQGEwJFVTEQMA4GA1UECBMHSG9sbGFuZDEQMA4GA1UEChMHbmNjREVNTzEdMBsG
A1UEAxMUU29mdHdhcmUgUEtJIFRlc3RpbmcxHzAdBgkqhkiG9w0BCQEWEHNvZnRp
ZXNAcmlwZS5uZXQwHhcNMDMwOTA4MTU1MzI4WhcNMDQwOTA3MTU1MzI4WjCBhTEL
MAkGA1UEBhMCTkwxETAPBgNVBAoTCFJJUEUgTkNDMRAwDgYDVQQLEwdNZW1iZXJz
MRwwGgYDVQQDExN1ay5idC50ZXN0LXJlY2VpdmVyMTMwMQYJKoZIhvcNAQkBFiR0
ZXN0LXJlY2VpdmVyQGxpbnV4LnRlc3RsYWIucmlwZS5uZXQwggEiMA0GCSqGSIb3
DQEBAQUAA4IBDwAwggEKAoIBAQDBgC+vvUyTDrwKgwqasezysdsyUui09WrHlG4n
h34iiYvSLaIXs1UGSDVUu4ARHXCXVfakrvjqm169PPBaL9CaAVlqNOouMJ9bWyi7
ZNcQDmzzS3cldE2T3EXpVeeCDEKKp5bJ90L1DvI6eU12QmDOZD864T0RWQppjaRy
cxTg1XK9uYMO2B2BIS69GWDJ4OLaBOHv1AB9OfMfZ3ZIUa3WVlPjw+7AJeXjzmnH
K76BWbKQQysQCAbof8OmXu3+PJX3D8dEAVpJXybOlouDqvEzTdOE4+XpHrVEnMSp
OLTNfg4eTFWrubVqeI0ki9Z59TVh+92/fPNNybFaYDfKE63rAgMBAAGjggEIMIIB
BDAJBgNVHRMEAjAAMBEGCWCGSAGG+EIBAQQEAwIFoDALBgNVHQ8EBAMCBeAwGgYJ
YIZIAYb4QgENBA0WC1JJUEUgTkNDIENBMB0GA1UdDgQWBBT8R01hA7y2NTenW4ku
xifh/RuaYDCBmwYDVR0jBIGTMIGQgBQektR+9oFV/FdUJxPSSH00l4fui6F1pHMw
cTELMAkGA1UEBhMCRVUxEDAOBgNVBAgTB0hvbGxhbmQxEDAOBgNVBAoTB25jY0RF
TU8xHTAbBgNVBAMTFFNvZnR3YXJlIFBLSSBUZXN0aW5nMR8wHQYJKoZIhvcNAQkB
FhBzb2Z0aWVzQHJpcGUubmV0ggEAMA0GCSqGSIb3DQEBBAUAA4GBAIS97p16oXSe
8coUnRB8QlJSRFMIXtgLHslva0ogd8yButSzfH1ualKGkGQnCMSw1inRW+TuF+GI
WAozgAbJh3eFk2YXlz93SBq6q8v56Bv7dX5mD6wlPMcxUpAsXXJtaAmNTvk+L6Y7
sEbTOxDXelNjG5kJHZbXmfC3vMuIe2Z/MYICUjCCAk4CAQEwdzBxMQswCQYDVQQG
EwJFVTEQMA4GA1UECBMHSG9sbGFuZDEQMA4GA1UEChMHbmNjREVNTzEdMBsGA1UE
AxMUU29mdHdhcmUgUEtJIFRlc3RpbmcxHzAdBgkqhkiG9w0BCQEWEHNvZnRpZXNA
cmlwZS5uZXQCAgCEMAkGBSsOAwIaBQCggbEwGAYJKoZIhvcNAQkDMQsGCSqGSIb3
DQEHATAcBgkqhkiG9w0BCQUxDxcNMDQwMjIwMDk1OTU3WjAjBgkqhkiG9w0BCQQx
FgQUmD28ovlSAN12UM/WMF/oKJSxExgwUgYJKoZIhvcNAQkPMUUwQzAKBggqhkiG
9w0DBzAOBggqhkiG9w0DAgICAIAwDQYIKoZIhvcNAwICAUAwBwYFKw4DAgcwDQYI
KoZIhvcNAwICASgwDQYJKoZIhvcNAQEBBQAEggEATh3FA6BzBhvlepSF9JVMENYc
Ykegb+YZScZ0C6ygkgCnKQy4AXzw5QOu5XOqnxhHFv2kQFDD0McmeZ4f11rJezWT
/vTDTTY8OUy0Bqlyfrhau6SJplhzKY3OBHQorlmVoAz1oVeVavtz0yQfQtQ6sRrW
nUVR7sMZ9iYNVrCMImknjeWMQeGHOjnv+qQPY+PuVYPyJj+skm4B7035WWvMrah+
+PpHx3KQjiJsj9EJGcTfe11RSfI+tbeiqY8xJ6soPFIHgk2j4aV6SgeymTXdPtMI
I+2OSTWXQSaehF7pDlLG5zc3xD0y+KTvr+By0LTVM3NATWobcHCufTKecIb/lA==

------D96B4EE3933FD612217FA51738EB9194--

